<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="INFO">
	<Properties>
		<Property name="logPathProperty">log</Property>
		<Property name="patternLayoutProperty">[%highlight{%-5level}] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] [%c{1}.%M()] - %msg%n</Property>
		<Property name="logLevelProperty">${sys:logLevel:-info}</Property>
	</Properties>
	
	<Appenders>
		<Console name="consoleAppender" target="SYSTEM_OUT">
			<PatternLayout pattern="${patternLayoutProperty}"/>
		</Console>
		
		<Rounting name="routingAppender">
			<!-- log events are routed to different log file based on the value of ThreadContext.put("testName") -->
			<Route>
				<RollingFile name="dynamicRollingFile"
							 fileName="${logPathProperty}/${ctx:testName}.log" 
							 filePattern="${logPathProperty}/${ctx:testName}_%d{yyyy-MM-dd}-%i.log.gz">
					<PatternLayout pattern="${patternLayoutProperty}"/>
					<Policies>
						<TimeBasedTriggerPolicy interval="1" modulate="true"/>
						<SizeBasedTriggerPolicy size="10MB"/>
					</Policies>
					<DefaultRolloverStrategy max="7"/>
				</RollingFile>
			</Route>
		</Rounting>
	</Appenders>
	
	<Loggers>
		<Root level="${logLevelProperty}">
			<AppenderRef ref="consoleAppender"/>
			<AppenderRef ref="routingAppender"/>
		</Root>
	</Loggers>
</Configuration>